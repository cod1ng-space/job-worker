Требуется создать job worker для обработки фоновых задач. Язык программирования - Go/Python/C++. Реализация на Go - большой плюс.

Это должна быть лёгкая, отказоустойчивая система с возможностью обработки задач в очереди.

Необходимо реализовать очередь задач, несколько воркеров для параллельной обработки, гибкую настройку (таймауты, ретраи, паузы) и предусмотреть возможность для интеграции. Задача со звездочкой - очередь задач с приоритетами, перезапуск невыполненных (по какой-либо причине) задач

Можно взять любую очередь сообщений, а также любой формат сообщения

Ограничения:

Количество задач в минуту - 100

Каждая задача выполняется максимум 3 секунды. Можно воспользоваться функцией:

func PerformJob(name string, jobData []byte) error {
    fmt.Printf("Started job %s at %d", name, time.Now().UnixMilli())

    // do some work. Random sleep time; max = 3s
    <-time.After(time.Duration(rand.Int63n(int64(3 * time.Second))))

    fmt.Printf("Finished job %s at %d", name, time.Now().UnixMilli())
    return nil
}
Критерии приемки:

Есть endpoint POST /jobs или PUT /jobs/{job_id}, по которому я могу поставить задачу в очередь
Есть endpoint GET /jobs/{job_id}, по которому я могу получить текущий статус задачи
Запуск системы происходит в докере/в кубере